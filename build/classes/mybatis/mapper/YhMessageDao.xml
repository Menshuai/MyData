<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "http://mybatis.org/dtd/mybatis-3-mapper.dtd" "mybatis-3-mapper.dtd" >
<mapper namespace="com.hnzy.pds.dao.YhMessageDao">
	<resultMap type="YhMessage" id="yhMessage">
	
		<result property="id" column="id" />
		<result property="yhbh" column="yhbh" />
		<result property="cgbh" column="cgbh" />
		<result property="xqm" column="xqm" />
		<result property="ldh" column="ldh" />
		
		<result property="dyh" column="dyh" />
		<result property="hh" column="hh" />
		<result property="fpdz" column="fpdz" />
		<result property="mj" column="mj" />
		<result property="yhlx" column="yhlx" />
		
		<result property="yhxm" column="yhxm" />
		<result property="lxdh" column="lxdh" />  
		<result property="bz" column="bz" />
		
		<result property="cg.cgbh" column="cgbh" />
		<result property="cg.jzqnet" column="jzqnet" />
		<result property="cg.azdz" column="azdz" />
		<result property="cg.bz" column="bz" />
		 
		<result property="cg.cgbh" column="cgbh" />
		<result property="cg.jzq.jzqnet" column="jzqnet" />
		<result property="cg.jzq.jzqip" column="jzqip" />
		<result property="cg.jzq.jzqport" column="jzqport" />
		<result property="cg.azdz" column="azdz" />  
		 
	</resultMap>
	 
	
	<!--查找小区名 public List<YhMessage> findXQN(); -->
	<select id="findXQN"  resultMap="yhMessage"  parameterType="YhMessage">
	select distinct xqm from k_yhb1b 
	</select>
	
	 <!--根据小区  查询楼栋 public List<YhMessage> findLDH(@Param("xqm")String xqm); -->
	<select  id="findLDH"   resultMap="yhMessage"  parameterType="YhMessage">
	select DISTINCT ldh from   k_yhb1b  where xqm=#{xqm}
	</select>
	
	<!--根据小区楼栋 查询单元    public List<YhMessage> findyhlx(@Param("xqm")String xqm,@Param("ldh")String ldh); -->
	<select id="findyhlx"  resultMap="yhMessage"  parameterType="YhMessage" >
		select DISTINCT dyh from  k_yhb1b  where xqm=#{xqm} and ldh=#{ldh}
	</select>
	
	<!--public List<YhMessage> find()  -->
	<select id="find"   resultMap="yhMessage"   parameterType="YhMessage">
		select  *  from  k_yhb1  
		
	</select>
	
	
	
	<!-- public List<YhMessage> findZ(@Param("xqm")String xqm,@Param("ldh")String ldh,@Param("yhlx")String yhlx); -->
	 <select id="findZ"   resultMap="yhMessage"  parameterType="YhMessage" >
	 select * from k_yhb1
	 
	 </select>
	 
	<!--查询小区 public List<YhMessage> findXQ() -->
	<select id="findXQ"   resultMap="yhMessage"  >
		select  xqm  from  k_yhb1 group by  xqm
	</select>
	
	<!--查询楼栋 public List<YhMessage> findBO(YhMessage village); -->
	<select id="findBO"  resultMap="yhMessage"  parameterType="YhMessage">
		select 
				ldh 
		from 
				k_yhb1
		where 
		 		xqm =#{xqm}
		group by ldh 
	</select>

	<!--查询单元与用户名  public List<YhMessage> findCO(YhMessage village) -->
	<select id="findCO"  resultMap="yhMessage"  parameterType="YhMessage">
	select 
		    dyh
		from  
			 k_yhb1
		where 
			xqm =#{xqm} and ldh =#{ldh}
		group by dyh
	</select>
	 
	<insert id="Insert" parameterType="YhMessage">
		insert into k_yhb1
		(yhbh,cgbh,xqm,ldh,dyh,hh,fpdz,mj,yhlx,yhxm,lxdh,bz)
		values
		  (#{yhbh},#{cgbh},#{xqm},#{ldh},#{dyh},#{hh},#{fpdz},#{mj},#{yhlx},#{yhxm},#{lxdh},#{bz})
 
	</insert>

	<delete id="delete" parameterType="YhMessage">
		delete from k_yhb1
		where id=#{id}
	</delete>
	
	<update id="update" parameterType="YhMessage">
		update k_yhb1 
		set
		yhbh=#{yhbh},cgbh=#{cgbh},xqm=#{xqm},ldh=#{ldh},dyh=#{dyh},hh=#{hh},
		fpdz=#{fpdz},mj=#{mj},yhlx=#{yhlx},
		yhxm=#{yhxm},lxdh=#{lxdh},bz=#{bz}
		where id=#{id}
	</update>
	
	<!-- public YhMessage  findJzq(String cgbh) -->
	<select  id="findJzq" parameterType="YhMessage"   resultMap="yhMessage" >
	select distinct
		yh.cgbh, cg.cgbh , jzq.jzqip, jzq.jzqport
	 from   k_yhb1  yh,  k_cgb3  cg,  k_jzqb5  jzq
	 where yh.cgbh=cg.cgbh  
	 and   cg.jzqnet=jzq.jzqnet and yh.yhbh=#{cgbh}
	</select>
	
	<!-- public  YhMessage finldh(String  yhbh) -->
	<select id="finldh" parameterType="YhMessage"   resultMap="yhMessage">
	select  ldh,cgbh,dyh  from k_yhb1 where yhbh=#{yhbh} and fpdz=#{fpdz}
	</select>
	
	<!-- public  YhMessage findyh(String  yhbh) -->
	<select id="findyh" parameterType="YhMessage"   resultMap="yhMessage">
	select  distinct ldh,cgbh,dyh from k_yhb1 where yhbh=#{yhbh}
	</select>

	  
	<!--查找小区名字 public List<YhMessage> findXqName(); -->
	<select id="findXqName" parameterType="YhMessage"   resultMap="yhMessage">
		select  xqm from k_yhb1 
	</select>
	
	<!--通过小区 获取楼栋  public List<YhMessage> findYhBuildNObyXqm(String xqm); -->
	<select id="findYhBuildNObyXqm" resultMap="yhMessage" parameterType="YhMessage">
		select ldh from k_yhb1 where xqm=#{xqm}
	</select>
	
	<!--通过小区楼栋获取单元  public List<YhMessage> findYhCellNOByBuild(int ldh,String xqm); -->
	<select id="findYhCellNOByBuild" resultMap="yhMessage"><!-- 不写传参类型parameterType的话，前面传递的多个参数默认封装成map，顺序取就行了#{0} 代表第一个参数。 -->
		select dyh from k_yhb1 where xqm=#{1} and ldh=#{0} 
	</select>
	
	<!-- <select id="findYhhhByBuild" resultMap="yhMessage" parameterType="YhMessage">
		select hh from k_yhb1 where xqm=#{xqm} and ldh=#{ldh} and dyh=#{dyh} 
	</select> -->
	
	
	<!-- 搜索实时数据-->
	<select id="searchInfo" resultMap="yhMessage" parameterType="YhMessage">
      select 
			*
	  from
			k_yhb1 , k_data10 
	  where 
			 k_yhb1.yhbh=k_data10.yhbh  and k_yhb1.fpdz=k_data10.fpdz  
		<if test="xqm!='--选择小区名称--'">
			and xqm=#{xqm}
		</if>
		<if test="ldh!=0">
			and ldh=#{ldh}
		</if>
		<if test="dyh!=0">
			and dyh=#{dyh}
		</if>
		<if test="hh!=0">
			and hh=#{hh}
		</if>
		<if test="time1!=null and time1!=''">
			and time &gt;= #{time1}
		</if>
		<if test="time2!=null and time2!=''">
			and time &lt;= #{time2}
		</if>   
		order by time desc  
	</select>
	
	<!-- 搜索 历史数据-->
	<select id="searchHistory" resultMap="yhMessage" parameterType="YhMessage">
      select 
			*
	  from
			k_yhb1 , k_lssjb11 
	  where 
			k_yhb1.yhbh=k_lssjb11.yhbh  and k_yhb1.fpdz=k_lssjb11.fpdz
	 	<if test="xqm!='--选择小区名称--'">
			and xqm=#{xqm}
		</if>
		<if test="ldh!=null and ldh!=''">
			and ldh=#{ldh}
		</if>
		<if test="dyh!=null and dyh!=''">
			and dyh=#{dyh}
		</if>
		<if test="hh!=null and hh!=''">
			and hh=#{hh}
		</if>
		<if test="time1!=null and time1!=''">
			and time &gt;= #{time1}
		</if>
		<if test="time2!=null and time2!=''">
			and time &lt;= #{time2}
		</if> 
		order by time desc  
	</select>
</mapper>

