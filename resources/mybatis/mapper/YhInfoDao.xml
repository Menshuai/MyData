<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "http://mybatis.org/dtd/mybatis-3-mapper.dtd" "mybatis-3-mapper.dtd" >
<mapper namespace="com.hnzy.pds.dao.YhInfoDao">
	<resultMap type="YhInfo" id="yhInfo">
		<id property="id" column="ID" />
		<result property="valAd" column="ValAd" />
		<result property="xqName" column="XqName" />
		<result property="buildNo" column="BuildNO" />
		<result property="cellNo" column="CellNO" />
		<result property="houseNo" column="HouseNO" />
		<result property="yhName" column="YhName" />
		<result property="idNum" column="IDNum" />
		<result property="rbAd" column="RbAd" />
		<result property="rbType" column="RbType" />
		<result property="telephone" column="Telephone" />
		<result property="mobilephone" column="Mobilephone" />
		<result property="email" column="Email" />
		<result property="buileArea" column="BuileArea" />
		<result property="userArea" column="UseArea" />
		<result property="heatArea" column="HeatArea" />
		<result property="billway" column="BillWay" />
		<result property="sfjf" column="SFJF" />
		<result property="sfqf" column="SFQF" />
		<result property="sftr" column="SFTR" />
		<result property="wcad" column="WCAd" />
		<result property="azwz" column="AZWZ" />
		<result property="ylfq" column="YLFQ" />
		<result property="LH" column="LH"/>
		<result property="dYH" column="DYH"/>
		<result property="xq" column="XQ"/>
		<result property="hESName" column="HESName"/>
		<result property="jfsj" column="JFSJ" />
		<result property="bz" column="Bz" />
		<result property="datetime" column="datetime" />
		<result property="faultInfor" column="FaultInfor" />
		<result property="yhfl" column="Yhfl" />
		<result property="cou" column="cou"/>
		<result property="bjxx" column="Bjxx"/>
		<result property="bjTime" column="BjTime"/>
		<result property="LH" column="LH"/>
		<result property="CS" column="CS"/>
		<result property="SH" column="SH"/>
		<result property="jFZT" column="JFZT"/>
		<result property="yHKH" column="YHKH"/>
		<result property="yhbm" column="YHBM" />
		<result property="yhRb" column="YhRb" />
		<result property="cjq" column="Cjq" />
		<association property="fmHistory" javaType="com.hnzy.pds.pojo.FmHistory">
			<id property="id" column="ID" />
			<result property="valAd" column="ValAd" />
			<result property="status" column="Status" />
			<result property="famKd" column="FamKd" />
			<result property="lockSt" column="LockSt" />
			<result property="jfSt" column="JFSt" />
			<result property="valTemp" column="ValTemp" />
			<result property="roomTemp" column="RoomTemp" />
			<result property="hTemSet" column="HTemSet" />
			<result property="mTemSet" column="MTemSet" />
			<result property="lTemSet" column="LTemSet" />
			<result property="recordTime" column="RecordTime" />
			<result property="tqyb" column="Tqyb" />
		</association>
	</resultMap>
	 <select id="find" resultMap="yhInfo">
		select XqName from T_YhInfo where XqName='砥柱大厦' group by
		XqName
	</select>
	
		
	 <select id="findrepair" resultMap="yhInfo">
		select distinct XqName from KFGL  order by XqName
	</select>
	
	<sql id="xq">
		  and Yhfl!='退费停暖'
		<if test="xqName!='--选择小区名称--'">
			and XqName=#{xqName}
		</if>
		<if test="buildNo!=0">
			and BuildNO=#{buildNo}
		</if>
		<if test="cellNo!=0">
			and CellNO=#{cellNo}
		</if>
		<if test="sfjf!='--选择缴费状态--'">
			and SFJF=#{sfjf}
		</if>
		<if test="status!='--选择阀门状态--'">
			and Status=#{status}
		</if>
		</sql>
		
		
		<select id="findYhBuildNObyXqName" resultMap="yhInfo"
		parameterType="YhInfo">
		select BuildNO from T_YhInfo where XqName=#{xqName}
		group by BuildNO
	</select>
	<select id="findYhCellNOByBuild" resultMap="yhInfo"
		parameterType="YhInfo">
		select CellNO from T_YhInfo where XqName=#{1} and
		BuildNO=#{0} group by
		CellNO
	</select>
		<select id="findYhHouseNOByBuild" resultMap="yhInfo"
		parameterType="YhInfo">
		select HouseNO from T_YhInfo where XqName=#{2} and
		BuildNO=#{1} and CellNO=#{0} group by HouseNO
		
	</select>
	
	
		
		 <!-- 查询处   public List<YhInfo> findPlace();-->
		<select id=""  resultMap="yhInfo" parameterType="YhInfo">
			select distinct place  from  KFGL
		</select> 
		
	<!-- 根据处,换热站选择小区 -->
	<select id="findXqNamebyPlace" resultMap="yhInfo" parameterType="YhInfo">
	select distinct XqName from KFGL where Place=#{place} and HESName=#{hESName}  order by XqName
	</select>
	
	<!-- 楼栋 -->
	<select id="findYhBuildNObyXqNamerepair" resultMap="yhInfo"
		parameterType="YhInfo">
		select distinct LH from KFGL where XqName=#{xqName} and Place=#{place} and HESName=#{hESName} order by LH
	</select>
	
	<!-- 单元 -->
	<select id="findYhCellNOByBuildrepair" resultMap="yhInfo"
		parameterType="YhInfo">
		select distinct DYH from KFGL where XqName=#{xqName} and Place=#{place} and HESName=#{hESName} and
		LH=#{LH} order by DYH
	 </select>
	
	
	<select id="findFmId" resultMap="yhInfo" parameterType="YhInfo">
	select XqName,BuildNo,CellNo,HouseNo from T_YhInfo  where ValAd=#{valAd}
	</select>
	
	<select id="searchInfo" resultMap="yhInfo" parameterType="YhInfo">
      select 
		T_FmInfo.ValAd ,Tqyb,XqName,BuildNO,CellNO,HouseNO,Status,FamKd,LockSt,SFJF,ValTemp,RoomTemp,HTemSet,MTemSet,LTemSet,RecordTime
		from
		T_YhInfo , T_FmInfo
		where T_YhInfo.ValAd=T_FmInfo.ValAd 
		<if test="xqName!='--选择小区名称--'">
			and XqName=#{xqName}
		</if>
		<if test="buildNo!=0">
			and BuildNO=#{buildNo}
		</if>
		<if test="cellNo!=0">
			and CellNO=#{cellNo}
		</if>
		<if test="houseNo!=0">
			and HouseNO=#{houseNo}
		</if>
		<if test="sfjf!='--选择缴费状态--'">
			and SFJF=#{sfjf}
		</if>
		<if test="valTemp1!=null and valTemp1!=''">
			and valTemp  &gt;= #{valTemp1}
		</if>
		<if test="valTemp2!=null and valTemp2!=''">
			and valTemp &lt;= #{valTemp2}
		</if>
		<if test="roomTemp1!=null and roomTemp1!=''">
			and roomTemp &gt;= #{roomTemp1}
		</if>
			<if test="roomTemp2!=null and roomTemp2!=''">
			and roomTemp &lt;= #{roomTemp2}
		</if>
		<if test="recordTime1!=null and recordTime1!=''">
			and recordTime &gt;= #{recordTime1}
		</if>
		<if test="recordTime2!=null and recordTime2!=''">
			and recordTime &lt;=#{recordTime2}
		</if>
		<if test="famKd!=null and famKd!=''">
			and FamKd=#{famKd}
		</if>
     order by RecordTime desc
	</select>
	
	
	
	<select id="findXqInfoFmHistory" resultMap="yhInfo">
		select 
		top 100 XqName,Tqyb,BuildNO,CellNO,HouseNO,Status,FamKd,LockSt,SFJF,JFSt,ValTemp,RoomTemp,HTemSet,MTemSet,LTemSet,RecordTime 
		from T_YhInfo y,T_FmInfo fm
		where y.ValAd=fm.ValAd and XqName='砥柱大厦' order by y.ID Desc
	</select>
</mapper>
